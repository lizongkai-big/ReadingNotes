#要挣钱，就别怕脏

用户只向解决**困难**问题的公司付钱
编写一个设计优雅、易于使用的应用程序，同解决“麻烦事”有相仿的效果。

#循证式日程规划

1. 分解时间
   1. 将日程规划分解成一些非常小的任务，这些任务能够在以“小时”为单位的时间段中完成。不能有任何任务所需要的时间超过16小时
   2. 这就迫使你想清楚自己要干什么，而不是对要做的事马马虎虎
2. 追踪时间的用途
   1. 记录你在每项任务上花费的时间
   2. 以后，你就可以回过头来参考这些数据，估计一下新的任务相对需要的时间
   3. 然后，又可以用实际用时 / 估计用时，得到任务的完成速率的历史数据集合；一般为0.6
3. 对未来情况进行模拟
   1. 使用估计用时随机地除以完成速率，就能估计出当前日程规划完成需要的时间
   2. 当你的完成速率比较稳定时，每完成一轮模拟，得到的完成时间都差不多，最后就得到了一个非常窄的项目日期分布时间
4. 不要有强迫症
   1. 不需要事无巨细地把所有事情都记录下来，只需要按照自己的安排去做就行
   2. 认为这些小事情以后仍会发生
5. 积极管理你的项目
   1. 通过记录下来的实际用时，改进估计水平 or 减去一些任务
   2. 目的都是为了让项目按时完成
6. 范围渐变
   1. 在原始规划时，你应该为以下的情况留出缓冲：新的功能设想，对手的新动向，整合中出现的问题，解决各种错误，易用性测试，软件Beta版的测试
   2. 如果缓冲时间用完了，该怎么办？接着记录任务完成日期，继续对未来情况进行模拟，不然嘞？
7. 我们的做法
   1. 只有第一线的程序员才能提出完成日期的估计值
   2. 一发现错误就立即修正，将用时算入原始任务的用时之中。这有助于循证式日程规划预计出得到**可靠代码**所需的时间，而不只是可以运行的初步代码
   3. 防止管理层向程序员施加压力，要求加快开发速度
   4. 一份日程规划就是一个装满木块的盒子。如果有一堆木块，你无法将它们装入盒子，你就只有两个选择，要么找一个大一点的盒子（延长工作日期），要么拿掉几个木块（去掉不重要，没用的功能，不能因为有趣简单但是没用、不重要就做一个功能）。

每个项目的一开始花上一两天时间做一个详细的规划，然后每天花几十秒在工作时间记录单上记录下你何时开始完成一项新任务。



# 让错误的代码显而易见

## 变量的命名

不安全的变量，如那些直接从用户处获取的变量以 us (unsafe) 作为前缀，而安全的变量（如已经 HTML 编码过的）用 s(safe) 作为前缀。进而函数名也采用类似的规则，返回安全变量的以 s 为前缀，如 sEncode，返回不安全变量的以 us 为前缀，如 usRequest;而操作安全变量的用 s 为后缀，如 writeS，等。

## 一些通用规则

- 尽量将函数写得简短
- 变量声明的位置离使用的位置越近越好
- 不要使用宏去创建你自己的编程语言
- 不要使用 goto
- 不要让右括号与对应的左括号之间的距离超过一个显示屏

以上这些规则的共同点是：让一行代码相关的所有信息尽可能靠拢，缩短物理距离，这将大大增加你一眼看出程序内部是怎么回事的机会。

寻找一种代码的书写规范，让错误的代码变得容易被看出。让代码中的相关信息在显示屏上集中在一起，使你能够当场发现和改正某些种类的错误。

## 匈牙利命名法

### 正确的匈牙利命名法

也叫做 “应用型匈牙利命名法” Apps Hungarian，它用前缀表示变量的种类(kind)，这是非常有用的。

匈牙利命名法的几种使用举例：

- us (unsafe) 前缀表示不安全的字符串， s (safe) 表示安全字符串
- 在 Excel 源码中，用 rw 前缀指行，col 前缀指列
- cb 前缀代表字节个数 count of bytes
- ix 表示数组的索引值 index
- c 表示计数器 count
- d 表示两个数量之间的差额，如 dx

### 错误的匈牙利命名法，也叫 “系统型匈牙利命名法”

被误解的匈牙利命名法用前缀来表示变量的类型(type)，这没什么大用处。

几种使用举例：

- l 表示长整型 long
- ul 表示 unsigned long
- dw 表示 double word

## 避免使用异常处理

异常处理结构破坏了代码的关联性，相关的代码会分散到不同的地方。为了了解某一行代码是否运行正常，你不得不到其它地方寻找答案，因此就不能利用人的眼睛一目了然的优势学着看出错误的代码。

基于相同的原因，也要避免使用宏。

> 参考文献：

- 《软件随想录》2009 邮电，作者 Joel Spolsky，翻译阮一峰: 编程建议