## 面向字节流VS面向报文

面向报文的传输方式：UDP对应用层交下来的报文，既不合并，也不拆分，而是保留这些报文的边界。这也就是说，应用层交给UDP多长的报文，UDP就照样发送，即一次发送一个报文。

面向字节流的话，虽然应用程序和TCP的交互是一次一个数据块（大小不等），但TCP把应用程序看成是一连串的无结构的字节流。TCP有一个缓冲，当应用程序传送的数据块太长，TCP就可以把它划分短一些再传送。如果应用程序一次只发送一个字节，TCP也可以等待积累有足够多的字节后再构成报文段发送出去。

在默认的阻塞模式下，TCP无边界，UDP有边界。	



## [理解HTTP幂等性](https://www.cnblogs.com/weidagang2046/archive/2011/06/04/idempotence.html)

<u>HTTP方法的幂等性是指一次和多次请求某一个资源应该具有同样的副作用。</u>幂等性是分布式系统设计中十分重要的概念，而HTTP的分布式本质也决定了它在HTTP中具有重要地位。

### 分布式事务 VS 幂等设计

分布式事务的优点是对于调用者很简单，复杂性都交给了中间件来管理。缺点则是一方面架构太重量级，容易被绑在特定的中间件上，不利于异构系统的集成；另一方面分布式事务虽然能保证事务的ACID性质，而但却无法提供性能和可用性的保证。

和分布式事务相比，幂等设计的优势在于它的**轻量级**，容易适应异构环境，以及性能和可用性方面。在某些性能要求比较高的应用，幂等设计往往是唯一的选择。

## HTTP的幂等性

HTTP GET方法用于获取资源，不应有副作用，所以是幂等的。

HTTP DELETE方法用于删除资源，有副作用，但它应该满足幂等性。调用一次和N次对系统产生的副作用是相同的

POST表示创建资源，PUT表示更新资源。二者均可用于创建资源，更为本质的差别是在幂等性方面。两次相同的POST请求会在服务器端创建两份资源，对同一URI进行多次PUT的副作用和一次PUT是相同的；因此，PUT方法具有幂等性，POST不具有。



## DNS解析过程

浏览器搜索自己的 DNS 缓存，查找成功返回其对应 IP 地址，失败则进行下一步；

搜索系统中的 DNS 缓存，查找成功返回其对应 IP 地址，失败则进行下一步；

搜索系统中的 hosts 文件，查找成功返回其对应 IP 地址，失败则进行下一步；

系统发送一个请求到路由器上，路由器查找其缓存，查找成功返回其对应 IP 地址，失败则进行下一步；

系统将域名发送至 LDNS（本地域名服务器），查找成功返回其对应 IP 地址，失败则 LDNS 向 Root Name Server（根域名服务器）发起请求获得域的顶级域名服务器地址，然后依次请求获得各级域名服务器地址，最后获得域名对应 IP 地址；

LDNS 将 IP 地址返回给操作系统并缓存起来；

系统将  IP 地址返回给浏览器并缓存起来；

浏览器获得 IP 地址，发起建立连接的请求。



## [浏览器渲染过程](https://juejin.im/post/59f29c06f265da43310d1067)

用户输入网址（假设是个 HTML 页面，并且是第一次访问），浏览器向服务器发出请求，服务器返回 HTML 文件；

浏览器开始载入代码，发现 ＜head＞ 标签内有一个 ＜link＞ 标签引用外部 CSS 文件；

浏览器又发出 CSS 文件的请求，服务器返回这个 CSS 文件；

浏览器继续载入 HTML 中 ＜body＞ 部分的代码，并且 CSS 文件已经拿到手了，可以开始渲染页面了；

浏览器在代码中发现一个 ＜img＞ 标签引用了一张图片，向服务器发出请求，此时浏览器不会等到图片下载完，而是继续渲染后面的代码；

服务器返回图片文件，由于图片占用了一定面积，影响了后面段落的排布，因此会发生回流，浏览器需要回过头来重新布局和绘制这部分元素；

浏览器发现了一个包含一行 JavaScript 代码的 script 标签，赶快运行它；

JavaScript 脚本执行了这条语句，它命令浏览器隐藏掉代码中的某个 ＜div＞ (style.display=”none”)，于是又发生了回流，浏览器不得不重新布局和绘制这部分元素；

终于等到了 ＜/html＞ 的到来，浏览器泪流满面；

等等，还没完，用户点了一下界面中的「换肤」按钮，JavaScript 让浏览器换了一下 ＜link＞ 标签的 CSS 路径；

浏览器召集了在座的各位 ＜div＞＜span＞＜ul＞＜li＞ 们，“大伙儿收拾收拾行李，咱得重新来过……”，浏览器向服务器请求了新的 CSS 文件，重新渲染页面。

## 客户端-服务器模式/架构

请求-响应模式

### 2层 VS 3层

3层架构多了一个中间件层，用来执行安全检查和负载均衡



## 应用层协议

DNS（53，可以用TCP、UDP，主要是基于UDP实现）、----->>[HttpDNS](https://www.jianshu.com/p/6ee14391e04e) 和LocalDNS最大的区别在与：前者使用HTTP协议进行域名解析；后者协议运行在UDP协议之上，使用端口号53。httpsDNS主要用于避免DNS劫持、平均访问延迟较高、用户连接失败率较高

Http（80）、

FTP、TFTP、SNMP、SMTP、POP3、Telnet、DHCP、NTP

